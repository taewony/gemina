# Python을 이용한 Markdown → PPTX 변환 스크립트 (`ppt_gen.py`)

## 1. 개요

`ppt_gen.py`는 특정 규칙에 따라 작성된 마크다운(Markdown) 파일을 읽어 파워포인트(.pptx) 프레젠테이션으로 자동 변환하는 Python 스크립트입니다. 이 스크립트의 목적은 문서 작성과 슬라이드 생성을 일원화하여 생산성을 높이는 것입니다.

---

## 2. 요구사항

-   **입력**: `---`로 슬라이드가 구분된 마크다운 파일 1개.
-   **출력**: 마크다운 내용이 반영된 `.pptx` 파일.
-   **주요 기능**:
    -   슬라이드 자동 분리
    -   슬라이드 제목 자동 인식 (`#` 또는 `##`)
    -   글머리 기호 및 들여쓰기 목록 지원
    -   굵은 글씨(`**text**`) 서식 지원
    -   코드 블록(```)을 서식이 적용된 별도 도형으로 표시

---

## 3. 마크다운 작성 규칙

스크립트가 올바르게 동작하려면 마크다운 파일은 다음 규칙을 따라야 합니다.

1.  **슬라이드 구분**: 각 슬라이드의 내용은 수평선(`---`)으로 구분합니다.
2.  **슬라이드 제목**: 각 슬라이드에는 `#` 또는 `##`으로 시작하는 제목이 한 줄 포함되어야 합니다.
3.  **코드 블록**: 코드 블록은 ` ``` ` 기호로 감싸야 합니다.
4.  **굵은 글씨**: 굵게 표시할 텍스트는 별 두 개(`**`)로 감쌉니다. (예: `**중요**`)

### 예시

```markdown
# 첫 번째 슬라이드 제목

이것은 **일반 텍스트**입니다.
- 첫 번째 목록 항목
  - 들여쓰기된 항목

---

## 📂 두 번째 슬라이드

```
# 이것은 코드 블록입니다.
print("Hello, World!")
```
```

---

## 4. 주요 구현 방식

### 가. 3단계 파싱(Parsing) 로직

스크립트는 마크다운을 3단계에 걸쳐 분석합니다.

1.  **슬라이드 분리**: `\n---\n` 정규식을 기준으로 전체 마크다운 내용을 개별 슬라이드의 텍스트 덩어리로 분리합니다.
2.  **내용 종류 분리**: 각 슬라이드 텍스트 내에서 **제목**, **일반 텍스트**, **코드 블록**을 다시 분리합니다. 이를 통해 각 내용에 다른 서식을 적용할 준비를 합니다.
3.  **서식 적용 파싱**:
    -   **일반 텍스트**: 줄 단위로 순회하며 글머리 기호(`-`, `*`), 들여쓰기, 굵은 글씨(`**`)를 감지하고 `python-pptx`의 `run` 객체에 서식을 적용합니다.
    -   **코드 블록**: 코드 블록은 일반 텍스트와 완전히 분리하여 처리합니다.

### 나. 일반 텍스트와 코드 블록의 분리 렌더링

-   **일반 텍스트**: 슬라이드의 기본 '내용' Placeholder에 텍스트를 추가하고, `paragraph`와 `run` 객체를 조작하여 글머리 기호, 굵은 글씨 등의 서식을 적용합니다.
-   **코드 블록**: 일반 텍스트와 서식이 충돌하는 것을 막기 위해, **별도의 사각형 도형(Shape)을 동적으로 생성**합니다. 이 도형 안에 코드 블록 내용을 넣고, 고정폭 글꼴, 왼쪽 정렬, 연한 회색 배경 등 코드에 특화된 서식을 독립적으로 적용합니다. 이 방식은 복잡한 서식 문제를 해결하고 가독성을 크게 향상시킵니다.

### 다. 오류 처리 및 안정성

-   `python-pptx` 라이브러리의 일부 속성(`paragraph_format`)이 특정 조건에서 오류를 발생시키는 문제를 회피하기 위해, 텍스트를 먼저 추가한 후 서식을 적용하는 안정적인 2단계 처리 방식을 채택했습니다.
-   `p.text = ''` 와 같이 단락의 내용을 안전하게 초기화하는 방식을 사용하여 객체 모델 관련 오류를 방지합니다.

## 5. 라이브러리 의존성

-   `python-pptx`: PPTX 파일을 생성하고 조작하기 위해 필요합니다.

```bash
pip install python-pptx
```

